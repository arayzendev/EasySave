<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:EasySave.GUI.ViewModels"
             x:Class="EasySave.GUI.Views.ExecuteJobsView"
             x:DataType="vm:ExecuteJobsViewModel">

    <Grid RowDefinitions="Auto, *, Auto">
        <Grid.Background>
            <RadialGradientBrush Center="50%,50%" GradientOrigin="50%,50%" Radius="0.8">
                <GradientStop Color="#1e1e2d" Offset="0" />
                <GradientStop Color="#14141b" Offset="1" />
            </RadialGradientBrush>
        </Grid.Background>

        <Border Grid.Row="0" Padding="25" Background="#1Affffff" BorderBrush="#22ffffff" BorderThickness="0,0,0,1">
            <Grid ColumnDefinitions="*, Auto">
                <StackPanel>
                    <TextBlock Text="{Binding TitleText}" FontSize="24" FontWeight="Bold" Foreground="White"/>
                    <TextBlock Text="Sélectionnez les travaux à orchestrer simultanément" FontSize="11" Foreground="#888c9b" Margin="0,5,0,0"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="15" VerticalAlignment="Center">
                    <TextBlock Text="{Binding StrategyLabel}" Foreground="White" VerticalAlignment="Center" FontSize="13"/>
                    <ComboBox ItemsSource="{Binding Strategies}" SelectedItem="{Binding SelectedStrategy}" 
                              Width="160" Background="#2a2a3d" BorderThickness="1" CornerRadius="8"/>
                </StackPanel>
            </Grid>
        </Border>

        <ScrollViewer Grid.Row="1" Padding="20">
            <ListBox ItemsSource="{Binding Jobs}" 
                     SelectionMode="Multiple"
                     SelectionChanged="OnSelectionChanged"
                     Background="Transparent" BorderThickness="0">
                <ListBox.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel Orientation="Horizontal" />
                    </ItemsPanelTemplate>
                </ListBox.ItemsPanel>
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Border Width="260" Height="110" Background="#2a2a3d" CornerRadius="12" Padding="15" Margin="8"
                                BoxShadow="0 4 10 0 #40000000">
                            <Grid RowDefinitions="*, Auto, Auto">
                                <StackPanel Grid.Row="0">
                                    <TextBlock Text="{Binding name}" Foreground="White" FontSize="16" FontWeight="SemiBold" TextTrimming="CharacterEllipsis"/>
                                    <TextBlock Text="{Binding strategyType}" Foreground="#727cf5" FontSize="10" FontWeight="Bold"/>
                                </StackPanel>
                                
                                <ProgressBar Grid.Row="1" Value="{Binding backupProgress.Progress}" Minimum="0" Maximum="100" 
                                             Height="5" CornerRadius="3" Foreground="#727cf5" Background="#1Affffff" Margin="0,12,0,5"/>
                                
                                <TextBlock Grid.Row="2" Text="{Binding backupProgress.Progress, StringFormat={}{0:0}%}" 
                                           Foreground="#888c9b" FontSize="10" HorizontalAlignment="Right"/>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </ScrollViewer>

        <Border Grid.Row="2" Padding="25" Background="#14141b" BorderBrush="#22ffffff" BorderThickness="0,1,0,0">
            <Grid ColumnDefinitions="Auto, *, Auto">
                <Button Grid.Column="0" Content="{Binding BackBtnText}" Command="{Binding BackCommand}" 
                        Background="Transparent" Foreground="#888c9b" FontSize="14"/>
                
                <Button Grid.Column="2" Content="{Binding ExecuteBtnText}" Command="{Binding ExecuteCommand}" 
                        Background="#727cf5" Foreground="White" Width="220" Height="48" CornerRadius="10"
                        FontSize="16" FontWeight="Bold" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"/>
            </Grid>
        </Border>
    </Grid>
</UserControl>